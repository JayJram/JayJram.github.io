{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Unified Payment VoMS Developer Manual - Product Description 1 Introduction 1.1 Validity of the Manual This manual is valid for Voucher Administration Update Tool (further in text abbreviated VouAdmUpdate) of the Unified Payment system. 1.2 Intended Audience VouAdmUpdate is designed to be operated by trained operators.This manual describes the user interface for the VouAdmUpdate. It is assumed that the user is familiar with work under the RHEL operating system. 1.3 Related Manuals In addition to the present manual, we would like to draw your attention to the following specific manuals: The Unified Payment User Manual for VoMS The Unified Payment Operation Manual for VoMS intended for the users and administrators of the Unified Payment system. 1.4 Manual Structure Chapter Description 1 Describes the most important aspects of this manual. 2 Provides an overview of the VouAdmUpdate. 3 Describes the user interface. It includes a description of the operations that can be performed with VouAdmUpdate. 4 Provides a short description of the operation sequences. 5 A list of terms and abbreviations. 1.5 Typographical Conventions The following table explains the typographical conventions used in this manual. Font / type / style Meaning \"Subscriber administration\", \"View\" Names of GUI elements (titles of windows, button labels, menu items, etc.) are presented between double quotes. Courier Commands are shown in the Courier font. This font is also used for examples and inputs to be performed. \\ Sign used in a UNIX command line to indicate that the command will be continued in the next line. Italic File names and path names are shown in italics. Bold Important terms are indicated by bold print < parameter > Parameter to be substituted by an actual value. < Ctrl >, < Alt > Names of keys are delimited by arrow brackets. Braces {...} Names of variables are delimited by braces. Square brackets [ ] Used for keyboard shortcuts and command buttons.Examples:Close the application with [Alt] + [F4].Acknowledge this message by clicking on [OK]. Indicates supplementary information on the current topic. This supplementary information may be useful tips on operation, explanations, description of master conditions or similar information. Indicates a warning. If the instructions given are not observed, errors or data loss can occur. To avoid errors, always observe all the instructions following a warning. 2 Product Overview VouAdmUpdate is a self standing application designed specifically to run under Unified Payment system FARM node(s) which is supported on CAF framework on a RHEL based environment. It supports 3 modes of operations \u2013 chg_exp_date, chg_vou_state, chg_rech_value Based on input parameters (mode selected and input filename) the requested operation will be invoked for the voucher content in input filename. 3 User Interface VouAdmUpdate is a self-standing application offering command line user interface for Unified Payment environment (RHEL based). 3.1 Starting the VouAdmUpdate VouAdmUpdate tool is installed and configured for use at your Unified Payment system. VouAdmUpdate can be found in /export/home directory both Unified Payment FARM nodes: /export/home 3.2 Delivered package Following files consist of the VouAdmUpdate package. | | File | Description | | ----------- | ----------- | | readme.txt | Readme text file with important information regarding VouAdmUpdate tool. Please read and get familiar with the content of this file. | |params.cfg|Configuration file used by VouAdmUpdate tool. Explanation of the parameters and valid values is provided in readme.txt and in this User Manual| |vou_adm_update.jar| VouAdmUpdate tool software file| |run_vou_adm_update.sh|VouAdmUpdate tool run shell script| 3.3 Prerequisites The following software are required to run the VouAdmUpdate tool (already available at your Unified Payment system): JAVA Runtime Edition 1.7 or later version Unified Payment on CAF framework Oracle RDBMS RHEL operating system 3.4 Important information, restrictions and limitations Start of file readme.txt Optiva Unified Payment VoMS standalone tool for change of voucher properties (voucher state, recharge value, expiration date) PLEASE NOTE THAT THIS TOOL OPERATES ON INDIVIDUAL VOUCHERS. PACKAGES OF THE VOUCHERS ARE NOT UPDATED. Usage Maximum 4 instances of the tool per node should be run in parallel Maximum 100.000 VSNs per file to be used It must be ensured by operator that the input file data does not overlap (overlapping VSNs will not lead to any serious issue, however last tool instance update will be saved in DB) prepare input plaintext file with voucher serial numbers (VSNs), 1 line = 1 VSN e.g. 9000000813960829 9000000805914165 9000000813960830 9000000805914166 Maximum number of VSNs per file: 100.000 configure parameters in params.cfg e.g. NEW_EXPIRATION_DATE format DD.MM.YYYY, used in case chg_exp_date NEW_EXPIRATION_DATE=31.12.2024 COMMENT - can be any string, max length 255 chars COMMENT=tool ext exp date 1 USERNAME - can be any string, max length 255 chars USERNAME=tool_user 1 used in case chg_vou_state, must be one of the following: D, L, E, B, R, U, X D = Disabled, L = Delivered, E = Enabled, B = Blocked, R = Usage Requested, U = Used, X = Deleted in case of E - Enabled, NEW_DEALER_NAME must be specified please note that the tool does not validate the state transition considering current state and voucher state diagram operator must take care to use proper voucher state! NEW_VOUCHER_STATE=B used in case chg_rech_value, in value in smallest units, must be existing recharge value defined in system please note that the tool does not validate if NEW_RECHARGE_VALUE is assigned to the OCS Account and Voucher Provider of the voucher operator must take care to use proper recharge value! NEW_RECHARGE_VALUE=5000 used in case chg_vou_state, must be existing Dealer Name defined in system NEW_DEALER_NAME=Omantel_Dealer run the tool ./run_vou_adm_update.sh < mode > < input_file > < MODE > = chg_exp_date, chg_vou_state, chg_rech_value < INPUT_FILE > = plain text file with VSNs to change, one VSN per line Example: ./run_vou_adm_update.sh chg_vou_state input_vsn_1.txt tool runs in nohup - if required to stop it, kill the nohup process Example: ps -ef | grep vou_adm_update kill -9 < PID of vou_adm_update > log files are written during tool execution Example: root@wrohp472 # head vou_adm_update_log_20210107.214932.log Current working directory: /root/ExpUpdate1 {PORT=1535, PASS=5agreb.~VO, HOST=10.47.34.194, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2024, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST2DB1} Update Started! 1610052572575 Oracle driver registered Connected to DB Line 1 Invalid data asdf9000000805914164 Line skipped Update: 1002 of 40000 records updated. 2.50 percent complete Current processing speed: 41.85 records per second Estimate until end: 931.90 seconds = 15.53 minutes Update: 2002 of 40000 records updated. 5.01 percent complete | Update: 39001 of 40000 records updated. 97.50 percent complete Current processing speed: 44.60 records per second Estimate until end: 22.40 seconds = 0.37 minutes Update Finished! Duration: 896 seconds Processed Records: 39999 Rejected Records: 1 Duplicate Records: 0 Update Finished! Duration: 14 minutes root@wrohp472 # head VouExpUpdate.log Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate < init > INFO: Processing linenr 1 line: asdf9000000805914164 Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicates SEVERE: Skipped line 1: invalid data: asdf9000000805914164 Line skipped Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate < init > INFO: Processing linenr 2 line: 9000000813960829 Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate < init > INFO: Processing linenr 3 line: 9000000805914165 Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate < init > INFO: Processing linenr 4 line: 9000000813960830 End of file 3.4 Usage of VouAdmUpdate Apply the following file rights and ownership to run VouAdmUpdate tool (already configured at your Unified Payment system): -rw-r--r-- 1 root root 6862374 Mar 30 15:45 vou_adm_update.jar -rwxr-xr-x 1 root root 150 Mar 30 15:48 run_vou_adm_update.sh -rw-r--r-- 1 root root 4108 Mar 30 15:55 readme.txt -rw-r--r-- 1 root root 627 Mar 30 15:57 params.cfg The user follows this syntax to use the VouAdmUpdate tool: nohup ./run_vou_adm_update.sh < MODE > < INPUT_FILE > & Script runs as an uninterruptible background process in nohup. It is possible to run multiple instances of the tool, deployed at separate directory locations to achieve parallelism. However, operators must ensure not to use overlapping vouchers in the input files of the instances of the tool. Script Parameters: Parameter Description MODE Indicates the mode of operation of the VouAdmUpdate tool. Valid values are chg_exp_date, chg_vou_state, chg_rech_value chg_exp_date - Change Voucher Expiration Date chg_vou_state - Change Voucher State chg_rech_value - Change Voucher Recharge Value INPUT_FILE Plain text input file with Voucher Serial Numbers (VSNs) to change, one VSN per line 3.5 Erroneous input In case of erroneous input, following output will be received. Case 1) Wrong number of arguments Wrong number of arguments. Usage: vou_adm_tool.sh < MODE > < INPUT_FILE > < MODE > = chg_exp_date, chg_vou_state, chg_rech_value < INPUT_FILE > = plain text file with VSNs to change, one VSN per line Case 2) Wrong mode specified Wrong mode specified. Usage: vou_adm_tool.sh < MODE > < INPUT_FILE > < MODE > = chg_exp_date, chg_vou_state, chg_rech_value < INPUT_FILE > = plain text file with VSNs to change, one VSN per line Case 3) Non-existing input file Current working directory: /export/home/VouAdmUpdate {PORT=1533, PASS=5agreb.~VO, NEW_VOUCHER_STATE=B, NEW_DEALER_NAME=DummyDealer, NEW_RECHARGE_VALUE=5000, HOST=172.16.100.34, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2026, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST1DB} Input file /export/home/VouAdmUpdate/dummyfile.txt not found! Exiting program! 4 Operation Sequences 4.1 Example of starting the VouAdmUpdate Tool in \u201cchg_exp_date\u201d mode We shall be using the following config parameter in the params.cfg file for this example. NEW_EXPIRATION_DATE=31.12.2026 In command line prompt as user root located in /export/home/VouAdmUpdate directory on 1st FARM node of Unified Payment system, run following command: nohup ./run_vou_adm_update.sh chg_exp_date input.txt & Follow the command by pressing an additional < RETURN > to return to OS prompt. Tool will create a log file with following filename syntax: VouAdmUpdate_YYYYMMDDHHMISS.log Example content of the nohup.out file: Current working directory: /export/home/ExpUpdate1 {PORT=1533, PASS=5agreb.~VO, NEW_VOUCHER_STATE=E, NEW_DEALER_NAME=TestDealer, NEW_RECHARGE_VALUE=20000, HOST=172.16.100.34, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2026, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST1DB} Update Started! 1617019696054 Oracle driver registered Connected to DB Line 96 Invalid data Line skipped Update Finished! Duration: 2 seconds Processed Records: 96 Rejected Records: 1 Duplicate Records: 0 Update Finished! Duration: 0 minutes root@wrofj228boam # Output contains: -current used config parameters read from param.cfg -info about connecting to database -progress status data -any errors -upon completion, the summary about the update results Example content of the log file: Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 1 line: 100000000904 Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesExpDate INFO: Line 1: voucher with serialnr: 100,000,000,904 expiration date changed from 12/31/21 11:59 PM to 12/31/26 11:59 PM Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 2 line: 100000000905 Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesExpDate INFO: Line 2: voucher with serialnr: 100,000,000,905 expiration date changed from 12/31/21 11:59 PM to 12/31/26 11:59 PM Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 3 line: 100000000906 Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesExpDate INFO: Line 3: voucher with serialnr: 100,000,000,906 expiration date changed from 12/31/21 11:59 PM to 12/31/26 11:59 PM Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 4 line: 100000000907 Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesExpDate INFO: Line 4: voucher with serialnr: 100,000,000,907 expiration date changed from 12/31/21 11:59 PM to 12/31/26 11:59 PM Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 5 line: 100000000908 Output contains: for each voucher/line, an log entry is written containing the status of its update, also the current/old value and new/updated value of the voucher property being updated progress status data any errors upon completion, the summary about the update results 4.2 Example of starting the VouAdmUpdate Tool in \u201cchg_vou_state\u201d mode We shall be using the following config parameter in the params.cfg file for this example. NEW_VOUCHER_STATE=B In command line prompt as user root located in /export/home/VouAdmUpdate directory on 1st FARM node of Unified Payment system, run following command: nohup ./run_vou_adm_update.sh chg_vou_state input.txt & Follow the command by pressing an additional < RETURN > to return to OS prompt. Tool will create a log file with following filename syntax: VouAdmUpdate_YYYYMMDDHHMISS.log Example content of the nohup.out file: Current working directory: /export/home/ExpUpdate1 {PORT=1533, PASS=5agreb.~VO, NEW_VOUCHER_STATE=B, NEW_DEALER_NAME=DummyDealer, NEW_RECHARGE_VALUE=20000, HOST=172.16.100.34, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2026, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST1DB} Update Started! 1617025831007 Oracle driver registered Connected to DB Line 96 Invalid data Line skipped Update Finished! Duration: 2 seconds Processed Records: 96 Rejected Records: 1 Duplicate Records: 0 Update Finished! Duration: 0 minutes Output contains: current used config parameters read from param.cfg info about connecting to database progress status data any errors upon completion, the summary about the update results Example content of the log file: Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 1 line: 100000000904 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 1: voucher with serialnr: 100,000,000,904 voucher state changed from E to B Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 2 line: 100000000905 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 2: voucher with serialnr: 100,000,000,905 voucher state changed from E to B Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 3 line: 100000000906 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 3: voucher with serialnr: 100,000,000,906 voucher state changed from E to B Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 4 line: 100000000907 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 4: voucher with serialnr: 100,000,000,907 voucher state changed from E to B Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 5 line: 100000000908 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 5: voucher with serialnr: 100,000,000,908 voucher state changed from E to B root@wrofj228boam # Output contains: for each voucher/line, an log entry is written containing the status of its update, also the current/old value and new/updated value of the voucher property being updated progress status data any errors upon completion, the summary about the update results 4.3 Example of starting the VouAdmUpdate Tool in \u201cchg_rech_value\u201d mode We shall be using the following config parameter in the params.cfg file for this example. NEW_RECHARGE_VALUE=5000 In command line prompt as user root located in /export/home/VouAdmUpdate directory on 1st FARM node of Unified Payment system, run following command: nohup ./run_vou_adm_update.sh chg_rech_value input.txt & Follow the command by pressing an additional < RETURN > to return to OS prompt. Tool will create a log file with following filename syntax: VouAdmUpdate_YYYYMMDDHHMISS.log Current working directory: /export/home/ExpUpdate1 {PORT=1533, PASS=5agreb.~VO, NEW_VOUCHER_STATE=B, NEW_DEALER_NAME=DummyDealer, NEW_RECHARGE_VALUE=5000, HOST=172.16.100.34, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2026, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST1DB} Update Started! 1617026090428 Oracle driver registered Connected to DB Line 96 Invalid data Line skipped Update Finished! Duration: 2 seconds Processed Records: 96 Rejected Records: 1 Duplicate Records: 0 Update Finished! Duration: 0 minutes Output contains: current used config parameters read from param.cfg info about connecting to database progress status data any errors upon completion, the summary about the update results Example content of the log file: Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 1 line: 100000000904 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 1: voucher with serialnr: 100,000,000,904 recharge value changed from 1,000 to 5,000 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 2 line: 100000000905 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 2: voucher with serialnr: 100,000,000,905 recharge value changed from 1,000 to 5,000 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 3 line: 100000000906 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 3: voucher with serialnr: 100,000,000,906 recharge value changed from 1,000 to 5,000 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 4 line: 100000000907 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 4: voucher with serialnr: 100,000,000,907 recharge value changed from 1,000 to 5,000 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 5 line: 100000000908 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 5: voucher with serialnr: 100,000,000,908 recharge value changed from 1,000 to 5,000 Output contains: for each voucher/line, an log entry is written containing the status of its update, also the current/old value and new/updated value of the voucher property being updated progress status data any errors upon completion, the summary about the update results 5 Terms Term Meaning VouAdmUpdate Voucher Administration Update Tool (subject of this User Manual). Unified Payment Application of the CAF framework used for management of voucher data. Voucher A voucher is a prepaid coupon which can be used for anonymous calling up to the amount of the voucher's value without the need for concluding a contract with a provider.Each voucher has an identification number, which is covered by rub-off coating \u2013 VoucherID and a Serial Number, used for identification/printing purpose. Dealer Identification of the company/entity that sells the vouchers on the market Voucher Expiration Date Date by which the voucher can be used for recharging. Voucher State State of the voucher, used for voucher business operations workflow validations Voucher Recharge Value The recharge value of the voucher (the denomination), by which the account of the OCS Subscriber will be recharged","title":"Unified Payment VoMS"},{"location":"#unified-payment-voms","text":"","title":"Unified Payment VoMS"},{"location":"#developer-manual-product-description","text":"","title":"Developer Manual - Product Description"},{"location":"#1-introduction","text":"","title":"1 Introduction"},{"location":"#11-validity-of-the-manual","text":"This manual is valid for Voucher Administration Update Tool (further in text abbreviated VouAdmUpdate) of the Unified Payment system.","title":"1.1 Validity of the Manual"},{"location":"#12-intended-audience","text":"VouAdmUpdate is designed to be operated by trained operators.This manual describes the user interface for the VouAdmUpdate. It is assumed that the user is familiar with work under the RHEL operating system.","title":"1.2 Intended Audience"},{"location":"#13-related-manuals","text":"In addition to the present manual, we would like to draw your attention to the following specific manuals: The Unified Payment User Manual for VoMS The Unified Payment Operation Manual for VoMS intended for the users and administrators of the Unified Payment system.","title":"1.3 Related Manuals"},{"location":"#14-manual-structure","text":"Chapter Description 1 Describes the most important aspects of this manual. 2 Provides an overview of the VouAdmUpdate. 3 Describes the user interface. It includes a description of the operations that can be performed with VouAdmUpdate. 4 Provides a short description of the operation sequences. 5 A list of terms and abbreviations.","title":"1.4 Manual Structure"},{"location":"#15-typographical-conventions","text":"The following table explains the typographical conventions used in this manual. Font / type / style Meaning \"Subscriber administration\", \"View\" Names of GUI elements (titles of windows, button labels, menu items, etc.) are presented between double quotes. Courier Commands are shown in the Courier font. This font is also used for examples and inputs to be performed. \\ Sign used in a UNIX command line to indicate that the command will be continued in the next line. Italic File names and path names are shown in italics. Bold Important terms are indicated by bold print < parameter > Parameter to be substituted by an actual value. < Ctrl >, < Alt > Names of keys are delimited by arrow brackets. Braces {...} Names of variables are delimited by braces. Square brackets [ ] Used for keyboard shortcuts and command buttons.Examples:Close the application with [Alt] + [F4].Acknowledge this message by clicking on [OK]. Indicates supplementary information on the current topic. This supplementary information may be useful tips on operation, explanations, description of master conditions or similar information. Indicates a warning. If the instructions given are not observed, errors or data loss can occur. To avoid errors, always observe all the instructions following a warning.","title":"1.5  Typographical Conventions"},{"location":"#2-product-overview","text":"VouAdmUpdate is a self standing application designed specifically to run under Unified Payment system FARM node(s) which is supported on CAF framework on a RHEL based environment. It supports 3 modes of operations \u2013 chg_exp_date, chg_vou_state, chg_rech_value Based on input parameters (mode selected and input filename) the requested operation will be invoked for the voucher content in input filename.","title":"2 Product Overview"},{"location":"#3-user-interface","text":"VouAdmUpdate is a self-standing application offering command line user interface for Unified Payment environment (RHEL based).","title":"3 User Interface"},{"location":"#31-starting-the-vouadmupdate","text":"VouAdmUpdate tool is installed and configured for use at your Unified Payment system. VouAdmUpdate can be found in /export/home directory both Unified Payment FARM nodes: /export/home","title":"3.1 Starting the VouAdmUpdate"},{"location":"#32-delivered-package","text":"Following files consist of the VouAdmUpdate package. | | File | Description | | ----------- | ----------- | | readme.txt | Readme text file with important information regarding VouAdmUpdate tool. Please read and get familiar with the content of this file. | |params.cfg|Configuration file used by VouAdmUpdate tool. Explanation of the parameters and valid values is provided in readme.txt and in this User Manual| |vou_adm_update.jar| VouAdmUpdate tool software file| |run_vou_adm_update.sh|VouAdmUpdate tool run shell script|","title":"3.2 Delivered package"},{"location":"#33-prerequisites","text":"The following software are required to run the VouAdmUpdate tool (already available at your Unified Payment system): JAVA Runtime Edition 1.7 or later version Unified Payment on CAF framework Oracle RDBMS RHEL operating system","title":"3.3 Prerequisites"},{"location":"#34-important-information-restrictions-and-limitations","text":"Start of file readme.txt Optiva Unified Payment VoMS standalone tool for change of voucher properties (voucher state, recharge value, expiration date) PLEASE NOTE THAT THIS TOOL OPERATES ON INDIVIDUAL VOUCHERS. PACKAGES OF THE VOUCHERS ARE NOT UPDATED. Usage Maximum 4 instances of the tool per node should be run in parallel Maximum 100.000 VSNs per file to be used It must be ensured by operator that the input file data does not overlap (overlapping VSNs will not lead to any serious issue, however last tool instance update will be saved in DB) prepare input plaintext file with voucher serial numbers (VSNs), 1 line = 1 VSN e.g. 9000000813960829 9000000805914165 9000000813960830 9000000805914166 Maximum number of VSNs per file: 100.000 configure parameters in params.cfg e.g. NEW_EXPIRATION_DATE format DD.MM.YYYY, used in case chg_exp_date NEW_EXPIRATION_DATE=31.12.2024 COMMENT - can be any string, max length 255 chars COMMENT=tool ext exp date 1 USERNAME - can be any string, max length 255 chars USERNAME=tool_user 1 used in case chg_vou_state, must be one of the following: D, L, E, B, R, U, X D = Disabled, L = Delivered, E = Enabled, B = Blocked, R = Usage Requested, U = Used, X = Deleted in case of E - Enabled, NEW_DEALER_NAME must be specified please note that the tool does not validate the state transition considering current state and voucher state diagram operator must take care to use proper voucher state! NEW_VOUCHER_STATE=B used in case chg_rech_value, in value in smallest units, must be existing recharge value defined in system please note that the tool does not validate if NEW_RECHARGE_VALUE is assigned to the OCS Account and Voucher Provider of the voucher operator must take care to use proper recharge value! NEW_RECHARGE_VALUE=5000 used in case chg_vou_state, must be existing Dealer Name defined in system NEW_DEALER_NAME=Omantel_Dealer run the tool ./run_vou_adm_update.sh < mode > < input_file > < MODE > = chg_exp_date, chg_vou_state, chg_rech_value < INPUT_FILE > = plain text file with VSNs to change, one VSN per line Example: ./run_vou_adm_update.sh chg_vou_state input_vsn_1.txt tool runs in nohup - if required to stop it, kill the nohup process Example: ps -ef | grep vou_adm_update kill -9 < PID of vou_adm_update > log files are written during tool execution Example: root@wrohp472 # head vou_adm_update_log_20210107.214932.log Current working directory: /root/ExpUpdate1 {PORT=1535, PASS=5agreb.~VO, HOST=10.47.34.194, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2024, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST2DB1} Update Started! 1610052572575 Oracle driver registered Connected to DB Line 1 Invalid data asdf9000000805914164 Line skipped Update: 1002 of 40000 records updated. 2.50 percent complete Current processing speed: 41.85 records per second Estimate until end: 931.90 seconds = 15.53 minutes Update: 2002 of 40000 records updated. 5.01 percent complete | Update: 39001 of 40000 records updated. 97.50 percent complete Current processing speed: 44.60 records per second Estimate until end: 22.40 seconds = 0.37 minutes Update Finished! Duration: 896 seconds Processed Records: 39999 Rejected Records: 1 Duplicate Records: 0 Update Finished! Duration: 14 minutes root@wrohp472 # head VouExpUpdate.log Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate < init > INFO: Processing linenr 1 line: asdf9000000805914164 Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicates SEVERE: Skipped line 1: invalid data: asdf9000000805914164 Line skipped Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate < init > INFO: Processing linenr 2 line: 9000000813960829 Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate < init > INFO: Processing linenr 3 line: 9000000805914165 Jan 07, 2021 9:49:33 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate < init > INFO: Processing linenr 4 line: 9000000813960830 End of file","title":"3.4 Important information, restrictions and limitations"},{"location":"#34-usage-of-vouadmupdate","text":"Apply the following file rights and ownership to run VouAdmUpdate tool (already configured at your Unified Payment system): -rw-r--r-- 1 root root 6862374 Mar 30 15:45 vou_adm_update.jar -rwxr-xr-x 1 root root 150 Mar 30 15:48 run_vou_adm_update.sh -rw-r--r-- 1 root root 4108 Mar 30 15:55 readme.txt -rw-r--r-- 1 root root 627 Mar 30 15:57 params.cfg The user follows this syntax to use the VouAdmUpdate tool: nohup ./run_vou_adm_update.sh < MODE > < INPUT_FILE > & Script runs as an uninterruptible background process in nohup. It is possible to run multiple instances of the tool, deployed at separate directory locations to achieve parallelism. However, operators must ensure not to use overlapping vouchers in the input files of the instances of the tool. Script Parameters: Parameter Description MODE Indicates the mode of operation of the VouAdmUpdate tool. Valid values are chg_exp_date, chg_vou_state, chg_rech_value chg_exp_date - Change Voucher Expiration Date chg_vou_state - Change Voucher State chg_rech_value - Change Voucher Recharge Value INPUT_FILE Plain text input file with Voucher Serial Numbers (VSNs) to change, one VSN per line","title":"3.4 Usage of VouAdmUpdate"},{"location":"#35-erroneous-input","text":"In case of erroneous input, following output will be received. Case 1) Wrong number of arguments Wrong number of arguments. Usage: vou_adm_tool.sh < MODE > < INPUT_FILE > < MODE > = chg_exp_date, chg_vou_state, chg_rech_value < INPUT_FILE > = plain text file with VSNs to change, one VSN per line Case 2) Wrong mode specified Wrong mode specified. Usage: vou_adm_tool.sh < MODE > < INPUT_FILE > < MODE > = chg_exp_date, chg_vou_state, chg_rech_value < INPUT_FILE > = plain text file with VSNs to change, one VSN per line Case 3) Non-existing input file Current working directory: /export/home/VouAdmUpdate {PORT=1533, PASS=5agreb.~VO, NEW_VOUCHER_STATE=B, NEW_DEALER_NAME=DummyDealer, NEW_RECHARGE_VALUE=5000, HOST=172.16.100.34, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2026, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST1DB} Input file /export/home/VouAdmUpdate/dummyfile.txt not found! Exiting program!","title":"3.5 Erroneous input"},{"location":"#4-operation-sequences","text":"","title":"4 Operation Sequences"},{"location":"#41-example-of-starting-the-vouadmupdate-tool-in-chg_exp_date-mode","text":"We shall be using the following config parameter in the params.cfg file for this example. NEW_EXPIRATION_DATE=31.12.2026 In command line prompt as user root located in /export/home/VouAdmUpdate directory on 1st FARM node of Unified Payment system, run following command: nohup ./run_vou_adm_update.sh chg_exp_date input.txt & Follow the command by pressing an additional < RETURN > to return to OS prompt. Tool will create a log file with following filename syntax: VouAdmUpdate_YYYYMMDDHHMISS.log Example content of the nohup.out file: Current working directory: /export/home/ExpUpdate1 {PORT=1533, PASS=5agreb.~VO, NEW_VOUCHER_STATE=E, NEW_DEALER_NAME=TestDealer, NEW_RECHARGE_VALUE=20000, HOST=172.16.100.34, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2026, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST1DB} Update Started! 1617019696054 Oracle driver registered Connected to DB Line 96 Invalid data Line skipped Update Finished! Duration: 2 seconds Processed Records: 96 Rejected Records: 1 Duplicate Records: 0 Update Finished! Duration: 0 minutes root@wrofj228boam # Output contains: -current used config parameters read from param.cfg -info about connecting to database -progress status data -any errors -upon completion, the summary about the update results Example content of the log file: Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 1 line: 100000000904 Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesExpDate INFO: Line 1: voucher with serialnr: 100,000,000,904 expiration date changed from 12/31/21 11:59 PM to 12/31/26 11:59 PM Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 2 line: 100000000905 Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesExpDate INFO: Line 2: voucher with serialnr: 100,000,000,905 expiration date changed from 12/31/21 11:59 PM to 12/31/26 11:59 PM Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 3 line: 100000000906 Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesExpDate INFO: Line 3: voucher with serialnr: 100,000,000,906 expiration date changed from 12/31/21 11:59 PM to 12/31/26 11:59 PM Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 4 line: 100000000907 Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesExpDate INFO: Line 4: voucher with serialnr: 100,000,000,907 expiration date changed from 12/31/21 11:59 PM to 12/31/26 11:59 PM Mar 29, 2021 2:08:17 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeExpiryDate INFO: Processing linenr 5 line: 100000000908 Output contains: for each voucher/line, an log entry is written containing the status of its update, also the current/old value and new/updated value of the voucher property being updated progress status data any errors upon completion, the summary about the update results","title":"4.1 Example of starting the VouAdmUpdate Tool in \u201cchg_exp_date\u201d mode"},{"location":"#42-example-of-starting-the-vouadmupdate-tool-in-chg_vou_state-mode","text":"We shall be using the following config parameter in the params.cfg file for this example. NEW_VOUCHER_STATE=B In command line prompt as user root located in /export/home/VouAdmUpdate directory on 1st FARM node of Unified Payment system, run following command: nohup ./run_vou_adm_update.sh chg_vou_state input.txt & Follow the command by pressing an additional < RETURN > to return to OS prompt. Tool will create a log file with following filename syntax: VouAdmUpdate_YYYYMMDDHHMISS.log Example content of the nohup.out file: Current working directory: /export/home/ExpUpdate1 {PORT=1533, PASS=5agreb.~VO, NEW_VOUCHER_STATE=B, NEW_DEALER_NAME=DummyDealer, NEW_RECHARGE_VALUE=20000, HOST=172.16.100.34, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2026, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST1DB} Update Started! 1617025831007 Oracle driver registered Connected to DB Line 96 Invalid data Line skipped Update Finished! Duration: 2 seconds Processed Records: 96 Rejected Records: 1 Duplicate Records: 0 Update Finished! Duration: 0 minutes Output contains: current used config parameters read from param.cfg info about connecting to database progress status data any errors upon completion, the summary about the update results Example content of the log file: Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 1 line: 100000000904 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 1: voucher with serialnr: 100,000,000,904 voucher state changed from E to B Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 2 line: 100000000905 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 2: voucher with serialnr: 100,000,000,905 voucher state changed from E to B Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 3 line: 100000000906 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 3: voucher with serialnr: 100,000,000,906 voucher state changed from E to B Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 4 line: 100000000907 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 4: voucher with serialnr: 100,000,000,907 voucher state changed from E to B Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeVoucherState INFO: Processing linenr 5 line: 100000000908 Mar 29, 2021 3:50:32 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesVouState INFO: Line 5: voucher with serialnr: 100,000,000,908 voucher state changed from E to B root@wrofj228boam # Output contains: for each voucher/line, an log entry is written containing the status of its update, also the current/old value and new/updated value of the voucher property being updated progress status data any errors upon completion, the summary about the update results","title":"4.2 Example of starting the VouAdmUpdate Tool in \u201cchg_vou_state\u201d mode"},{"location":"#43-example-of-starting-the-vouadmupdate-tool-in-chg_rech_value-mode","text":"We shall be using the following config parameter in the params.cfg file for this example. NEW_RECHARGE_VALUE=5000 In command line prompt as user root located in /export/home/VouAdmUpdate directory on 1st FARM node of Unified Payment system, run following command: nohup ./run_vou_adm_update.sh chg_rech_value input.txt & Follow the command by pressing an additional < RETURN > to return to OS prompt. Tool will create a log file with following filename syntax: VouAdmUpdate_YYYYMMDDHHMISS.log Current working directory: /export/home/ExpUpdate1 {PORT=1533, PASS=5agreb.~VO, NEW_VOUCHER_STATE=B, NEW_DEALER_NAME=DummyDealer, NEW_RECHARGE_VALUE=5000, HOST=172.16.100.34, USERNAME=tool_user 1, NEW_EXPIRATION_DATE=31.12.2026, USER=voms, DELTA_BATCH_SIZE=1000, COMMENT=tool ext exp date 1, SID=CUST1DB} Update Started! 1617026090428 Oracle driver registered Connected to DB Line 96 Invalid data Line skipped Update Finished! Duration: 2 seconds Processed Records: 96 Rejected Records: 1 Duplicate Records: 0 Update Finished! Duration: 0 minutes Output contains: current used config parameters read from param.cfg info about connecting to database progress status data any errors upon completion, the summary about the update results Example content of the log file: Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 1 line: 100000000904 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 1: voucher with serialnr: 100,000,000,904 recharge value changed from 1,000 to 5,000 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 2 line: 100000000905 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 2: voucher with serialnr: 100,000,000,905 recharge value changed from 1,000 to 5,000 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 3 line: 100000000906 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 3: voucher with serialnr: 100,000,000,906 recharge value changed from 1,000 to 5,000 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 4 line: 100000000907 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 4: voucher with serialnr: 100,000,000,907 recharge value changed from 1,000 to 5,000 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate changeRechargeValue INFO: Processing linenr 5 line: 100000000908 Mar 29, 2021 3:54:52 PM com.optiva.ope.voms.addon.vouexpdateupdater.external.DeltaUpdate getDuplicatesRechValue INFO: Line 5: voucher with serialnr: 100,000,000,908 recharge value changed from 1,000 to 5,000 Output contains: for each voucher/line, an log entry is written containing the status of its update, also the current/old value and new/updated value of the voucher property being updated progress status data any errors upon completion, the summary about the update results","title":"4.3 Example of starting the VouAdmUpdate Tool in \u201cchg_rech_value\u201d mode"},{"location":"#5-terms","text":"Term Meaning VouAdmUpdate Voucher Administration Update Tool (subject of this User Manual). Unified Payment Application of the CAF framework used for management of voucher data. Voucher A voucher is a prepaid coupon which can be used for anonymous calling up to the amount of the voucher's value without the need for concluding a contract with a provider.Each voucher has an identification number, which is covered by rub-off coating \u2013 VoucherID and a Serial Number, used for identification/printing purpose. Dealer Identification of the company/entity that sells the vouchers on the market Voucher Expiration Date Date by which the voucher can be used for recharging. Voucher State State of the voucher, used for voucher business operations workflow validations Voucher Recharge Value The recharge value of the voucher (the denomination), by which the account of the OCS Subscriber will be recharged","title":"5 Terms"}]}